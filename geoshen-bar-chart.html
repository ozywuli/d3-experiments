<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Geoshen Bar Chart</title>

    <style>

        .bar {
          fill: steelblue;
        }
        
        .bar:hover {
          fill: brown;
        }
        
        .axis--x path {
          display: none;
        }
        
    </style>
</head>
<body>

<svg width="960" height="500"></svg>

<script src="https://d3js.org/d3.v4.min.js"></script>

<script>

var svg = d3.select('svg');

const baseSettings = {
    margin: {
        top: 20,
        right: 20,
        bottom: 30,
        left: 40
    }
}

const extendedSettings = {
    width: +svg.attr('width') - baseSettings.margin.left - baseSettings.margin.right,
    height: +svg.attr('height') - baseSettings.margin.top - baseSettings.margin.bottom
}

const settings = Object.assign(baseSettings, extendedSettings);

var g = svg.append('g')
    .attr('transform', `translate(${settings.margin.left}, ${settings.margin.top})`);

d3.csv('data/letter-frequency.csv', function(d) {
    d.frequency = +d.frequency;
    return d;
}, function(error, data) {
    if (error) {
        throw error;
    }

    var x = d3.scaleBand()
        .domain(data.map(d => d.letter))
        .rangeRound([0, settings.width])
        .padding(0.1);

    var y = d3.scaleLinear()
        .domain([ 0, Math.round(d3.max(data, d => d.frequency) * 100) / 100 ]).rangeRound([settings.height, 0]);

    g.append('g')
        .attr('class', 'axis axis--x')
        .attr('transform', `translate(0, ${settings.height})`)
        .call(d3.axisBottom(x));

    g.append('g')
        .attr('class', 'axis axis--y')
        .call(d3.axisLeft(y).ticks(10, '%'))

    g.append('g')
        .attr('class', 'axis axis--y')
        // .attr('transform', `translate(${settings.width}, 0)`)
        .call(d3.axisLeft(y).tickFormat('').tickSize(-settings.width))

    
    g.selectAll('bar')
        .data(data)
        .enter()
        .append('rect')
            .attr('class', 'bar')
            .attr('x', d => x(d.letter))
            .attr('y', d => y(d.frequency))
            .attr('width', x.bandwidth())
            .attr('height', d => settings.height - y(d.frequency))

})


</script>


</body>
</html>